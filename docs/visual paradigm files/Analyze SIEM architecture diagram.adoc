:toc:
:author: Marko Owen
:docdatetime:
:stem: latexmath
:icons: font
:doctype: pdf
:pdf-version: 1.0
:blank:
:docname: Analyze

= Analyze SIEM Architecture Diagram

== Introduction


Based on the brief given by the boss, the security responsible, the company uses an on-premise solution based on Splunk.
The deployed architecture consists of a [.underline]#*_load balancer,
a MASTER NODE / LICENSER (Deployment Server), indexers,
and HEAVY FORWARDERS._*#

.Existing solution architecture
image::image-2023-01-31-22-38-50-973.png[width=550]


Regarding the current architecture, there is no high availability provided in any of the layers.

    * To achieve high availability, I can deploy a redundant architecture in the *Indexer layer*, using an active-passive configuration with two indexers for failover protection.
    * For the *search layer*, I can configure two search heads in active-active configuration.

    * Moreover, I can also configure a standby universal forwarder to ensure that data is still collected if the primary universal forwarder fails.


== Analysis of current architecture


=== High availability analysis

1. _Identify components with high availability_
• *_Load balancer_* provides high availability as it distributes requests between multiple indexers and prevents single points of failure.
• *_Indexers_* have high availability as multiple indexers can be deployed and data can be replicated between them.

2. _Identify components without high availability_
• *_MASTER NODE/LICENSER (Deployment Server)_* does not have high availability. To address this, a secondary deployment server can be installed and configured for failover.

• *_HEAVY FORWARDERS_* do not have high availability, a secondary heavy forwarder can be deployed and configured for failover.


3. Proposed plausible solutions to achieve high availability in components without it

.Solution to achieve high availability
image::image-2023-02-02-14-27-01-282.png[width=600]

=== Cost reduction study
1. Evaluated current architecture for cost optimization opportunities

• The current architecture can be modified to reduce costs by using the indexer cluster, which allows multiple indexers to work together and share the load.

2. Researched alternative solutions from the same manufacturer with cost-saving potential

• In order to reduce costs, consider deploying a cloud-based SIEM solution such as Microsoft Azure Sentinel.
Azure Sentinel provides a cost-effective solution with built-in scalability,
real-time analytics, and threat detection capabilities.
Additionally, I could consider Splunk Cloud,
which is a cloud-based version of Splunk Enterprise
and provides the same features and capabilities as the on-premise version.

• Another alternative is to use cloud-based solutions, such as Splunk Cloud, which can reduce hardware and maintenance costs.


3. Characteristics of the alternative solutions:

* *Cloud-based:* the solution utilizes cloud computing technology instead of local hardware.

* *Reduced hardware costs:* reliance on cloud infrastructure reduces the need for physical hardware.

* *Reduced maintenance costs:* the cloud provider handles maintenance responsibilities.

* *Use of Splunk Cloud:* the solution utilizes the specific cloud-based product Splunk Cloud.

== Storage needs calculation
=== Calculate disk size required for two years of data storage
To calculate the storage needs for two years with a given event rate, you will need to follow these steps:

1. *Determine the event rate:* This is the number of events, (e.g. log entries, transactions, etc.) per unit of time (e.g. per second, per day, etc.).
2. *Calculate the total number of events over two years:* Multiply the event rate by the number of seconds, minutes, hours, or days in two years, depending on the unit of time used in step 1.
3. *Estimate the size of each event:* Determine the amount of storage required for each event, taking into account factors such as the size of the data, any compression that will be used, and any additional overhead.
4. *Multiply the event size by the total number of events:* This will give you an estimate of the total amount of storage you will need over two years.
5. *Add a safety margin:* It's always a good idea to add a safety margin to account for unexpected growth or other factors. You can add anywhere from 10% to 50% of the total storage requirements, depending on your risk tolerance.

It is important to monitor the storage usage over time to ensure that I have enough storage and to make adjustments if needed.


1. Given event size of 560 bytes
2. Given minimum storage period of two years
3. Given average ingestion rate of 3000 EPS
4. Assume a compression ratio of 10:1

To calculate the storage needs for two years,
with an event size of 560 bytes and an average ingestion rate of 3000 events per second, using a compression ratio of 10:1, I can use the following formula:

.Storage size calculation
====
The following equation calculates the storage size needed for two years, given an event size of 560 bytes and an average ingestion rate of 3000 events per second, with a compression ratio of 10:1:

latexmath:[
Storage~size = (560 bytes * 3000 events/second * 60 seconds/minute * \\60 minutes/hour * 24 hours/day * 365 days/year * 2 years) / (compression~ ratio~ of~ 10:1)]

latexmath:[= (560 * 3000 * 60 * 60 * 24 * 365 * 2) / 10]

latexmath:[= approximately~ 2.5 ~Terabytes]

This is the minimum storage requirement needed to store the data for two years, assuming the compression ratio of 10:1. It is important to note that this calculation is an estimate and may not account for all factors that can impact storage requirements, such as the growth of data over time, the need for backups, and other factors.
====

== Comparative study of commercial SIEM solutions

=== Two manufacturers with complete architecture for SIEM solutions

.Here's a table comparing two SIEM solutions:
[cols="1,2,2"]
|===
|Feature|Elastic Stack|LogRhythm

|Cost
|Open-source, cost-effective
|Commercial, more expensive

|Scalability
|Scalable
|Scalable

|Security Features
|Limited security features
|Advanced security features

|Implementation
|Simple to implement
|Complex to implement

|Support
|Community support
|Commercial support

|===


NOTE: This table only compares the basic features and doesn't include the complete architecture comparison of the two solutions. The actual comparison will vary based on specific requirements and should be evaluated based on individual needs.


=== Analyze the functionalities of the solutions, including strengths and weaknesses

*Elastic Stack:*

* *Strengths:*

** Cost-effective
** Scalable
** Simple to implement

* *Weaknesses:*

** Limited security features
** Community support may not be as reliable as commercial support

*LogRhythm:*

* *Strengths:*

** Scalable
** Advanced security features
** Commercial support available for assistance and troubleshooting

* *Weaknesses:*

** More expensive than open-source solutions
** Complex to implement


=== Present a comparative study of the solutions

[cols="1,2,2"]
.Here's a table comparing two SIEM solutions:
|===
|Feature|SIEM Solution A|SIEM Solution B


|Cost
|Affordable
|More expensive


|Scalability
|Highly Scalable
|Scalable with limitations


|Security Features
|Comprehensive security features
|Advanced security features


|Implementation
|Easy to implement
|Complex to implement


|Data Ingestion
|Supports multiple data sources with real-time ingestion
|Supports limited data sources with near real-time ingestion


|Log Management
|Advanced log management features
|Basic log management features


|Threat Detection
|Advanced threat detection and response capabilities
|Limited threat detection and response capabilities


|Alerting and Notifications
|Customizable alerting and notifications
|Basic alerting and notifications


|Reporting and Dashboards
|Advanced reporting and dashboard capabilities
|Basic reporting and dashboard capabilities


|Support
|24/7 support available
|Limited support available

|===

NOTE: This table provides a comprehensive comparison of two SIEM solutions, However, the actual comparison will vary based on specific requirements and should be evaluated based on individual needs.